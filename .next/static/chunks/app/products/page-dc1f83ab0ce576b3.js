(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{4735:(e,r,a)=>{Promise.resolve().then(a.bind(a,2834))},2834:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>l});var o=a(5155),s=a(2115),t=a(6046);a(9208);var c=a(4496),i=a.n(c);function l(){let[e,r]=(0,s.useState)(null),[a,c]=(0,s.useState)(!0),[l,n]=(0,s.useState)([]),d=(0,t.useRouter)();return((0,s.useEffect)(()=>{(async()=>{let e=new URLSearchParams(window.location.search),a=localStorage.getItem("shop"),o=e.get("shop"),s=e.get("hmac");if(console.log("Shop from URL:",o),console.log("Shop from localStorage:",a),console.log("HMAC from URL:",s),!o||!s){d.replace("/login?shop=".concat(o||""));return}if(a!==o){d.replace("/login?shop=".concat(o));return}if(i().createHmac("sha256","ef556089912a5fdeed16e37bd12da7ef").update(a).digest("hex")!==s){console.error("HMAC mismatch: Invalid shop credentials"),d.replace("/login?shop=".concat(o));return}try{let e=await fetch("/api/verify-shop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:a,hmac:s})});if(!(await e.json()).isValid){r(!1),d.replace("/");return}r(!0);let o=await fetch("/api/products?shop=".concat(a)),t=await o.json();n(t.products||[])}catch(e){console.error("Error verifying shop or fetching products:",e),r(!1)}finally{c(!1)}})()},[d]),a)?(0,o.jsx)("p",{children:"Loading..."}):!1===e?(0,o.jsx)("p",{children:"Shop validation failed. Redirecting..."}):(0,o.jsxs)("div",{className:"products-container",children:[(0,o.jsx)("h1",{children:"Products"}),0===l.length?(0,o.jsx)("p",{children:"No products found."}):(0,o.jsx)("div",{className:"products-grid",children:l.map(e=>{var r,a;return(0,o.jsxs)("div",{className:"product-card",children:[(0,o.jsx)("img",{src:(null===(r=e.image)||void 0===r?void 0:r.src)||"/placeholder.jpg",alt:e.title,className:"product-image"}),(0,o.jsxs)("div",{className:"product-info",children:[(0,o.jsx)("p",{className:"product-title",children:e.title}),(0,o.jsxs)("p",{className:"product-price",children:["â‚¹",(null===(a=e.variants[0])||void 0===a?void 0:a.price)||"N/A"]})]})]},e.id)})})]})}a(6430)},6430:()=>{}},e=>{var r=r=>e(e.s=r);e.O(0,[471,268,289,441,517,358],()=>r(4735)),_N_E=e.O()}]);