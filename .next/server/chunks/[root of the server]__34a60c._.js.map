{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new%20-%202-14-25/shopify_new/my-app/src/app/api/verify-shop/route.js"],"sourcesContent":["// src\\app\\api\\verify-shop\\route.js\r\nimport { MongoClient } from \"mongodb\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nconst MONGO_URI = process.env.MONGO_URI;\r\nlet client = null;\r\n\r\nasync function getClient() {\r\n  if (!client) {\r\n    client = new MongoClient(MONGO_URI);\r\n    await client.connect();\r\n  }\r\n  return client;\r\n}\r\n\r\nexport async function GET() {\r\n  try {\r\n    const cookieStore = await cookies();\r\n    const shop = cookieStore.get(\"shop\")?.value;\r\n    const hmac = cookieStore.get(\"hmac\")?.value;\r\n\r\n    if (!shop || !hmac) {\r\n      return Response.json({ isValid: false });\r\n    }\r\n\r\n    const dbClient = await getClient();\r\n    const database = dbClient.db(\"spotifydata\");\r\n    const sessions = database.collection(\"sessions\");\r\n\r\n    const session = await sessions.findOne({ shop });\r\n\r\n    if (session) {\r\n      return Response.json({ isValid: true });\r\n    } else {\r\n      return Response.json({ isValid: false });\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error verifying shop:\", error);\r\n    return Response.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n  }\r\n}\r\n\r\n\r\n\r\n// // src/app/api/verify-shop/route.js\r\n// import { MongoClient } from \"mongodb\";\r\n// const MONGO_URI = process.env.MONGO_URI;\r\n// let client = null;\r\n// async function getClient() {\r\n//   if (!client) {\r\n//     client = new MongoClient(MONGO_URI);\r\n//     await client.connect();\r\n//   }\r\n//   return client;\r\n// }\r\n// export async function POST(req) {\r\n//   try {\r\n//     const { shop } = await req.json();\r\n//     // Ensure MongoDB client is connected\r\n//     const client = await getClient();\r\n//     const database = client.db(\"shopifyapp\");\r\n//     const sessions = database.collection(\"sessions\");\r\n//     // Check if the shop exists in the database\r\n//     const session = await sessions.findOne({ shop });\r\n//     // If the shop exists, return isValid: true\r\n//     if (session) {\r\n//       return Response.json({ isValid: true });\r\n//     } else {\r\n//       // If the shop does not exist, return isValid: false\r\n//       return Response.json({ isValid: false });\r\n//     }\r\n//   } catch (error) {\r\n//     console.error(\"Error verifying shop:\", error);\r\n//     return Response.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n//   }\r\n// }\r\n\r\n\r\n// import { MongoClient } from \"mongodb\";\r\n// const MONGO_URI = process.env.MONGO_URI;\r\n// const client = new MongoClient(MONGO_URI);\r\n// export async function POST(req) {\r\n//   try {\r\n//     const { shop } = await req.json();\r\n//     // Connect to MongoDB\r\n//     await client.connect();\r\n//     const database = client.db(\"shopifyapp\");\r\n//     const sessions = database.collection(\"sessions\");\r\n//     // Check if the shop exists in the database\r\n//     const session = await sessions.findOne({ shop });\r\n//     // If the shop exists, return isValid: true\r\n//     if (session) {\r\n//       return Response.json({ isValid: true });\r\n//     } else {\r\n//       // If the shop does not exist, return isValid: false\r\n//       return Response.json({ isValid: false });\r\n//     }\r\n//   } catch (error) {\r\n//     console.error(\"Error verifying shop:\", error);\r\n//     return Response.json({ error: \"Internal Server Error\" }, { status: 500 });\r\n//   } finally {\r\n//     await client.close();\r\n//   }\r\n// }"],"names":[],"mappings":"AAAA,mCAAmC;;;;AACnC;AACA;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,SAAS;AACvC,IAAI,SAAS;AAEb,eAAe;IACb,IAAI,CAAC,QAAQ;QACX,SAAS,IAAI,uGAAA,CAAA,cAAW,CAAC;QACzB,MAAM,OAAO,OAAO;IACtB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAChC,MAAM,OAAO,YAAY,GAAG,CAAC,SAAS;QACtC,MAAM,OAAO,YAAY,GAAG,CAAC,SAAS;QAEtC,IAAI,CAAC,QAAQ,CAAC,MAAM;YAClB,OAAO,SAAS,IAAI,CAAC;gBAAE,SAAS;YAAM;QACxC;QAEA,MAAM,WAAW,MAAM;QACvB,MAAM,WAAW,SAAS,EAAE,CAAC;QAC7B,MAAM,WAAW,SAAS,UAAU,CAAC;QAErC,MAAM,UAAU,MAAM,SAAS,OAAO,CAAC;YAAE;QAAK;QAE9C,IAAI,SAAS;YACX,OAAO,SAAS,IAAI,CAAC;gBAAE,SAAS;YAAK;QACvC,OAAO;YACL,OAAO,SAAS,IAAI,CAAC;gBAAE,SAAS;YAAM;QACxC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,SAAS,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IACzE;AACF,EAIA,sCAAsC;CACtC,yCAAyC;CACzC,2CAA2C;CAC3C,qBAAqB;CACrB,+BAA+B;CAC/B,mBAAmB;CACnB,2CAA2C;CAC3C,8BAA8B;CAC9B,MAAM;CACN,mBAAmB;CACnB,IAAI;CACJ,oCAAoC;CACpC,UAAU;CACV,yCAAyC;CACzC,4CAA4C;CAC5C,wCAAwC;CACxC,gDAAgD;CAChD,wDAAwD;CACxD,kDAAkD;CAClD,wDAAwD;CACxD,kDAAkD;CAClD,qBAAqB;CACrB,iDAAiD;CACjD,eAAe;CACf,6DAA6D;CAC7D,kDAAkD;CAClD,QAAQ;CACR,sBAAsB;CACtB,qDAAqD;CACrD,iFAAiF;CACjF,MAAM;CACN,IAAI;CAGJ,yCAAyC;CACzC,2CAA2C;CAC3C,6CAA6C;CAC7C,oCAAoC;CACpC,UAAU;CACV,yCAAyC;CACzC,4BAA4B;CAC5B,8BAA8B;CAC9B,gDAAgD;CAChD,wDAAwD;CACxD,kDAAkD;CAClD,wDAAwD;CACxD,kDAAkD;CAClD,qBAAqB;CACrB,iDAAiD;CACjD,eAAe;CACf,6DAA6D;CAC7D,kDAAkD;CAClD,QAAQ;CACR,sBAAsB;CACtB,qDAAqD;CACrD,iFAAiF;CACjF,gBAAgB;CAChB,4BAA4B;CAC5B,MAAM;CACN,IAAI"}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}