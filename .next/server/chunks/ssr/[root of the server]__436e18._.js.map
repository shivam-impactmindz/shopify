{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new%20-%202-14-25/shopify_new/my-app/src/app/products/page.js"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Cookies from \"js-cookie\";\r\nimport crypto from \"crypto\";\r\nimport \"@/app/styles/products.css\";\r\n\r\nconst SECRET_KEY = process.env.NEXT_PUBLIC_SHOPIFY_API_SECRET;\r\n\r\nexport default function ProductsPage() {\r\n  const [isValidShop, setIsValidShop] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [products, setProducts] = useState([]);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const verifyShopAndFetchProducts = async () => {\r\n      const params = new URLSearchParams(window.location.search);\r\n      const shop = localStorage.getItem(\"shop\");\r\n      const shopFromURL = params.get(\"shop\");\r\n      const hmac = params.get(\"hmac\");\r\n\r\n      console.log(\"Shop from URL:\", shopFromURL);\r\n      console.log(\"Shop from localStorage:\", shop);\r\n      console.log(\"HMAC from URL:\", hmac);\r\n\r\n      if (!shopFromURL || !hmac) {\r\n        router.replace(`/login?shop=${shopFromURL || \"\"}`);\r\n        return;\r\n      }\r\n\r\n      if (shop !== shopFromURL) {\r\n        router.replace(`/login?shop=${shopFromURL}`);\r\n        return;\r\n      }\r\n\r\n      // Generate HMAC on the client side\r\n      const generatedHmac = crypto.createHmac(\"sha256\", SECRET_KEY).update(shop).digest(\"hex\");\r\n      if (generatedHmac !== hmac) {\r\n        console.error(\"HMAC mismatch: Invalid shop credentials\");\r\n        router.replace(`/login?shop=${shopFromURL}`);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const verifyResponse = await fetch(\"/api/verify-shop\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify({ shop, hmac }),\r\n        });\r\n\r\n        const verifyData = await verifyResponse.json();\r\n        if (!verifyData.isValid) {\r\n          setIsValidShop(false);\r\n          router.replace(\"/\");\r\n          return;\r\n        }\r\n\r\n        setIsValidShop(true);\r\n\r\n        // Fetch products\r\n        const productsResponse = await fetch(`/api/products?shop=${shop}`);\r\n        const productsData = await productsResponse.json();\r\n\r\n        setProducts(productsData.products || []);\r\n      } catch (error) {\r\n        console.error(\"Error verifying shop or fetching products:\", error);\r\n        setIsValidShop(false);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    verifyShopAndFetchProducts();\r\n  }, [router]);\r\n\r\n  if (loading) return <p>Loading...</p>;\r\n  if (isValidShop === false) return <p>Shop validation failed. Redirecting...</p>;\r\n\r\n  return (\r\n    <div className=\"products-container\">\r\n      <h1>Products</h1>\r\n      {products.length === 0 ? (\r\n        <p>No products found.</p>\r\n      ) : (\r\n        <div className=\"products-grid\">\r\n          {products.map((product) => (\r\n            <div key={product.id} className=\"product-card\">\r\n              <img\r\n                src={product.image?.src || \"/placeholder.jpg\"}\r\n                alt={product.title}\r\n                className=\"product-image\"\r\n              />\r\n              <div className=\"product-info\">\r\n                <p className=\"product-title\">{product.title}</p>\r\n                <p className=\"product-price\">\r\n                  â‚¹{product.variants[0]?.price || \"N/A\"}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AAJA;;;;;;;AAOA,MAAM;AAES,SAAS;IACtB,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE,EAAE;IAC3C,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,6BAA6B;YACjC,MAAM,SAAS,IAAI,gBAAgB,OAAO,QAAQ,CAAC,MAAM;YACzD,MAAM,OAAO,aAAa,OAAO,CAAC;YAClC,MAAM,cAAc,OAAO,GAAG,CAAC;YAC/B,MAAM,OAAO,OAAO,GAAG,CAAC;YAExB,QAAQ,GAAG,CAAC,kBAAkB;YAC9B,QAAQ,GAAG,CAAC,2BAA2B;YACvC,QAAQ,GAAG,CAAC,kBAAkB;YAE9B,IAAI,CAAC,eAAe,CAAC,MAAM;gBACzB,OAAO,OAAO,CAAC,CAAC,YAAY,EAAE,eAAe,IAAI;gBACjD;YACF;YAEA,IAAI,SAAS,aAAa;gBACxB,OAAO,OAAO,CAAC,CAAC,YAAY,EAAE,aAAa;gBAC3C;YACF;YAEA,mCAAmC;YACnC,MAAM,gBAAgB,qGAAA,CAAA,UAAM,CAAC,UAAU,CAAC,UAAU,YAAY,MAAM,CAAC,MAAM,MAAM,CAAC;YAClF,IAAI,kBAAkB,MAAM;gBAC1B,QAAQ,KAAK,CAAC;gBACd,OAAO,OAAO,CAAC,CAAC,YAAY,EAAE,aAAa;gBAC3C;YACF;YAEA,IAAI;gBACF,MAAM,iBAAiB,MAAM,MAAM,oBAAoB;oBACrD,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBAAE;wBAAM;oBAAK;gBACpC;gBAEA,MAAM,aAAa,MAAM,eAAe,IAAI;gBAC5C,IAAI,CAAC,WAAW,OAAO,EAAE;oBACvB,eAAe;oBACf,OAAO,OAAO,CAAC;oBACf;gBACF;gBAEA,eAAe;gBAEf,iBAAiB;gBACjB,MAAM,mBAAmB,MAAM,MAAM,CAAC,mBAAmB,EAAE,MAAM;gBACjE,MAAM,eAAe,MAAM,iBAAiB,IAAI;gBAEhD,YAAY,aAAa,QAAQ,IAAI,EAAE;YACzC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8CAA8C;gBAC5D,eAAe;YACjB,SAAU;gBACR,WAAW;YACb;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,IAAI,SAAS,qBAAO,8OAAC;kBAAE;;;;;;IACvB,IAAI,gBAAgB,OAAO,qBAAO,8OAAC;kBAAE;;;;;;IAErC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;0BAAG;;;;;;YACH,SAAS,MAAM,KAAK,kBACnB,8OAAC;0BAAE;;;;;qCAEH,8OAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC,wBACb,8OAAC;wBAAqB,WAAU;;0CAC9B,8OAAC;gCACC,KAAK,QAAQ,KAAK,EAAE,OAAO;gCAC3B,KAAK,QAAQ,KAAK;gCAClB,WAAU;;;;;;0CAEZ,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAE,WAAU;kDAAiB,QAAQ,KAAK;;;;;;kDAC3C,8OAAC;wCAAE,WAAU;;4CAAgB;4CACzB,QAAQ,QAAQ,CAAC,EAAE,EAAE,SAAS;;;;;;;;;;;;;;uBAT5B,QAAQ,EAAE;;;;;;;;;;;;;;;;AAkBhC"}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new%20-%202-14-25/shopify_new/my-app/node_modules/js-cookie/dist/js.cookie.mjs"],"sourcesContent":["/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n"],"names":[],"mappings":"AAAA,2BAA2B,GAC3B,yBAAyB;;;AACzB,SAAS,OAAQ,MAAM;IACrB,IAAK,IAAI,IAAI,GAAG,IAAI,UAAU,MAAM,EAAE,IAAK;QACzC,IAAI,SAAS,SAAS,CAAC,EAAE;QACzB,IAAK,IAAI,OAAO,OAAQ;YACtB,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI;QAC3B;IACF;IACA,OAAO;AACT;AACA,wBAAwB,GAExB,yBAAyB,GACzB,IAAI,mBAAmB;IACrB,MAAM,SAAU,KAAK;QACnB,IAAI,KAAK,CAAC,EAAE,KAAK,KAAK;YACpB,QAAQ,MAAM,KAAK,CAAC,GAAG,CAAC;QAC1B;QACA,OAAO,MAAM,OAAO,CAAC,oBAAoB;IAC3C;IACA,OAAO,SAAU,KAAK;QACpB,OAAO,mBAAmB,OAAO,OAAO,CACtC,4CACA;IAEJ;AACF;AACA,wBAAwB,GAExB,yBAAyB,GAEzB,SAAS,KAAM,SAAS,EAAE,iBAAiB;IACzC,SAAS,IAAK,IAAI,EAAE,KAAK,EAAE,UAAU;QACnC,IAAI,OAAO,aAAa,aAAa;YACnC;QACF;QAEA,aAAa,OAAO,CAAC,GAAG,mBAAmB;QAE3C,IAAI,OAAO,WAAW,OAAO,KAAK,UAAU;YAC1C,WAAW,OAAO,GAAG,IAAI,KAAK,KAAK,GAAG,KAAK,WAAW,OAAO,GAAG;QAClE;QACA,IAAI,WAAW,OAAO,EAAE;YACtB,WAAW,OAAO,GAAG,WAAW,OAAO,CAAC,WAAW;QACrD;QAEA,OAAO,mBAAmB,MACvB,OAAO,CAAC,wBAAwB,oBAChC,OAAO,CAAC,SAAS;QAEpB,IAAI,wBAAwB;QAC5B,IAAK,IAAI,iBAAiB,WAAY;YACpC,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE;gBAC9B;YACF;YAEA,yBAAyB,OAAO;YAEhC,IAAI,UAAU,CAAC,cAAc,KAAK,MAAM;gBACtC;YACF;YAEA,kCAAkC;YAClC,MAAM;YACN,iEAAiE;YACjE,iBAAiB;YACjB,2DAA2D;YAC3D,iDAAiD;YACjD,MAAM;YACN,yBAAyB,MAAM,UAAU,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;QACxE;QAEA,OAAQ,SAAS,MAAM,GACrB,OAAO,MAAM,UAAU,KAAK,CAAC,OAAO,QAAQ;IAChD;IAEA,SAAS,IAAK,IAAI;QAChB,IAAI,OAAO,aAAa,eAAgB,UAAU,MAAM,IAAI,CAAC,MAAO;YAClE;QACF;QAEA,mEAAmE;QACnE,uCAAuC;QACvC,IAAI,UAAU,SAAS,MAAM,GAAG,SAAS,MAAM,CAAC,KAAK,CAAC,QAAQ,EAAE;QAChE,IAAI,MAAM,CAAC;QACX,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,IAAK;YACvC,IAAI,QAAQ,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC;YAC7B,IAAI,QAAQ,MAAM,KAAK,CAAC,GAAG,IAAI,CAAC;YAEhC,IAAI;gBACF,IAAI,QAAQ,mBAAmB,KAAK,CAAC,EAAE;gBACvC,GAAG,CAAC,MAAM,GAAG,UAAU,IAAI,CAAC,OAAO;gBAEnC,IAAI,SAAS,OAAO;oBAClB;gBACF;YACF,EAAE,OAAO,GAAG,CAAC;QACf;QAEA,OAAO,OAAO,GAAG,CAAC,KAAK,GAAG;IAC5B;IAEA,OAAO,OAAO,MAAM,CAClB;QACE;QACA;QACA,QAAQ,SAAU,IAAI,EAAE,UAAU;YAChC,IACE,MACA,IACA,OAAO,CAAC,GAAG,YAAY;gBACrB,SAAS,CAAC;YACZ;QAEJ;QACA,gBAAgB,SAAU,UAAU;YAClC,OAAO,KAAK,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,GAAG,IAAI,CAAC,UAAU,EAAE;QAC1D;QACA,eAAe,SAAU,SAAS;YAChC,OAAO,KAAK,OAAO,CAAC,GAAG,IAAI,CAAC,SAAS,EAAE,YAAY,IAAI,CAAC,UAAU;QACpE;IACF,GACA;QACE,YAAY;YAAE,OAAO,OAAO,MAAM,CAAC;QAAmB;QACtD,WAAW;YAAE,OAAO,OAAO,MAAM,CAAC;QAAW;IAC/C;AAEJ;AAEA,IAAI,MAAM,KAAK,kBAAkB;IAAE,MAAM;AAAI","ignoreList":[0]}},
    {"offset": {"line": 298, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}